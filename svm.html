<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Machine Learning SVM</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="stylesheet" href="static/css/style.css">
</head>

<nav class="navbar navbar-expand-lg navbar-dark bg-black">
    <a class="navbar-brand" href="index.html">Home</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Models
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="#">Decision Tree</a>
            <a class="dropdown-item" href="KNN.html">K-Nearest Neighbors</a>
            <a class="dropdown-item" href="LogisticRegression.html">Logistic Regression</a>
            <a class="dropdown-item" href="neural_network.html">Neural Network</a>
            <a class="dropdown-item" href="random_forest.html">Random Forest</a>
            <a class="dropdown-item" href="svm.html">Support Vector Machine</a>
          </div>
        </li>
      </ul>
    
    </div>
  </nav>

<main class="main">

  <section class="section">
    <figure class="image-container"><img src="static/images/vineyard4.jpg" alt=""/></figure>
    <article class="content">
      <h2 class="section-title">Support Vector Machine Model</h2>

      <p>Another model used on the datasets was the support vector machine, or SVM, model using the scikit-learn library in python. For these datasets, the linear kernel was used. It yielded similar accuracy scores as the other <a href="index.html" target="_blank">models</a>. 
          Initial accuracy scores on the test data yielded 0.58 for the red wine data and 0.51 for the white wine data. 
          Using the grid search function to find the best parameters for the SVM model did not yield better accuracy scores: 0.59 for the red wine data and 0.51 for the white wine data. 
      </p>
      
      <p>As seen in both the confusion matrices for red and white data, the SVM model only predicted quality scores of 5 or 6. This was expected given most of the red and white wine samples had a quality score of 5 or 6. 
              After quality scores of 5 and 6, wine samples with a quality score of 7 was the third most frequent score. 
              Despite this, the SVM model was not able to correctly predict any wines with a quality score of 7. Moreover, the SVM model was not able to distinguish higher quality wines (i.e. wines with quality scores of 7, 8, or 9) and thus predicted those wines to have lower quality scores (5 or 6).  
            </p>

      <img src="model_figures/SVM_conf_matrix_red.jpg" alt="SVM confusion matrix red wine">
      <p>Confusion matrix for the SVM model on red wine data</p>
      <img src="model_figures/SVM_conf_matrix_white.jpg" alt="SVM confusion matrix white wine">
      <p>Confusion matrix for the SVM model on white wine data</p>

      <p>After training the linear SVM model on the data it was important to explore what main features, in this case, what chemical properties were used by the model to classify the quality scores. 
          This was done by obtaining the coefficients of the classifiers using <code class="vy vz wa wb vh b">.coef_</code> on the SVM model. As seen in the plots below, volatile acidity was the most important feature in classifying the red wine data. Total sulfur dioxide and alcohol content were the next two imortant features. 
          Fixed acidity and pH level were the features with the smallest coefficients. 
        </p>
      <img src="model_figures/SVM_ftr_weight_red.jpg" alt="Coefficient weights red wine">
      <p>For the white wine data, the most important feature was free sulfur dioxide followed by alcohol content and fixed acidity. Density and chlorides had the smallest coefficients and had little importance in classifying the data.</p>
      <img src="model_figures/SVM_ftr_weight_white.jpg" alt="Coefficient weights white wine">
      <p></p>
    </article>
  </section>

</main>
<footer class="footer">Sa√∫de.</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.js"></script>

</html>
